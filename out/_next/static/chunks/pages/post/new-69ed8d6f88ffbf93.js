(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[967],{2457:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/post/new",function(){return n(819)}])},819:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var a=n(5893),l=n(7294),s=n(1163),u=n(4480),i=n(1693),o=n(3998),c=n(4082);n(6689);var r=n(1768),p=n(594),f=n(3412);function d(e){let t=(0,u.sJ)(f.KL),n=(0,s.useRouter)(),{Dragger:d}=i.Z,[h,g]=(0,l.useState)(""),[m,x]=(0,l.useState)(""),[j,_]=(0,l.useState)([]),[C,N]=(0,l.useState)(!1),w=new FormData,y=(0,l.useRef)(null),k=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(t.loggin){if(t.loggin&&!t.emailAuth){let e=confirm("YEH의 모든 기능 사용을 위해 이메일 인증을 완료해 주세요.");e?n.push("/user/signupComplete"):n.push("/")}}else{let a=confirm("로그인 후 이용 가능합니다. 로그인 페이지로 이동합니다.");a?n.push("/user/signin"):n.push("/")}},[]);let E=async()=>{if(""===h)return y.current.focus();if(""===m)return k.current.focus();{w.append("title",h),w.append("content",m);let e=r.ZP.load("accessToken"),t=j.map(e=>e.originFileObj);t.forEach(e=>w.append("imageFiles",e));try{await p.Z.post("/post/new",w,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}}).then(e=>{e.data.success?(alert(e.data.data),n.push("/")):alert("게시글 등록에 실패했습니다. 다시 시도해 주세요")})}catch(a){console.log(a),alert(a.data.data)}}},v=()=>{g(""),x(""),_(null)};return(0,a.jsxs)("div",{className:"post",children:[(0,a.jsx)("input",{type:"text",placeholder:"제목을 입력해 주세요",name:"title",autoComplete:"off",value:h,onChange:e=>g(e.target.value),ref:y}),(0,a.jsx)("textarea",{placeholder:"내용을 입력해 주세요",value:m,onChange:e=>x(e.target.value),ref:k}),(0,a.jsxs)(d,{name:"file",multiple:!0,maxCount:C?5:null,accept:"image/jpg,impge/png,image/jpeg,image/gif",onChange(e){_(e.fileList),e.fileList.length>5&&N(!0)},showUploadList:j.length>0,children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"5px"},children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(c.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"파일 업로드"})]}),(0,a.jsx)("p",{className:"ant-upload-hint",children:"첨부할 파일을 선택하거나 마우스로 드래그 해주세요."})]}),(0,a.jsxs)("div",{className:"postBtn",children:[(0,a.jsx)("button",{className:"cancle",onClick:v,children:"취소"}),(0,a.jsx)("button",{onClick:E,children:"등록"})]}),C?(0,a.jsx)(o.Z,{open:C,onOk:()=>N(!1),onCancel:()=>N(!1),cancelButtonProps:{style:{display:"none"}},width:"420px",children:(0,a.jsx)("p",{children:"첨부 이미지는 최대 5장까지 가능합니다."})}):null]})}},3412:function(e,t,n){"use strict";n.d(t,{DI:function(){return i},KL:function(){return u},zK:function(){return o}});var a=n(4480),l=n(6983);let{persistAtom:s}=(0,l.J)(),u=(0,a.cn)({key:"userState",default:{name:null,loggin:!1,emailAuth:!1},effects_UNSTABLE:[s]}),i=(0,a.cn)({key:"keywordState",default:{posts:null,postCount:0},effects_UNSTABLE:[s]}),o=(0,a.cn)({key:"pageState",default:1,effects_UNSTABLE:[s]})}},function(e){e.O(0,[236,492,761,314,998,28,563,774,888,179],function(){return e(e.s=2457)}),_N_E=e.O()}]);